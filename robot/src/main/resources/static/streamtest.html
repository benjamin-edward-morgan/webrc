<!DOCTYPE html>
<html>
<head>
<title>Websocket</title>
</head>

<script src="/webjars/jquery/2.1.1/jquery.min.js"></script>
<script src="/webjars/cometd/2.3.1/cometd.js"></script>
<script src="/webjars/cometd-jquery/2.3.1/jquery.cometd.js"></script>
<script>
	$(document).ready(function() {

		console.log("page loaded");

		var cometd = $.cometd;

		cometd.configure('http://localhost:8080/webrc/bayeux/');

		cometd.handshake(function(handshakeReply)
		{
			alert("hello");
		    if (handshakeReply.successful)
		    {
		        // Publish to a channel
		        cometd.publish('/data', { foo: 'bar' });
		    }
		});
		

		alert("page loaded");

		cometd.subscribe("/data", function(message) {
			console.log(message);
		}, function(subscribeReply) {
			alert("SUBSCRIBED1!!");
			if (subscribeReply.successful == true) {
				alert("SUBSCRIBED!!!");
			}

		});

		setInterval(function() {
			cometd.publish("/data", {
				"message" : "fuck you"
			});
		}, 2000);

	});
</script>

<body>
</body>
</html>